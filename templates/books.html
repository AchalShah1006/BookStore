{% extends "layout.html" %}
{% block title %}
<title>Books Store</title>
{% endblock %}

{% block nav %}
{% if session["user"] %}
<li class="nav-item active">
  <a class="nav-link text-success">Welcome! {{ name }}</a>
</li>
<li class="nav-item">
  <a class="nav-link text-primary" href="{{ url_for('logout') }}">Logout</a>
</li>

{% else %}
<li class="nav-item active">
  <a class="nav-link text-primary" href="{{ url_for('login') }}">Login</a>
</li>
<li class="nav-item">
  <a class="nav-link text-primary" href="{{ url_for('signup') }}">Sign Up</a>
</li>
{% endif %}
{% endblock %}

{% block main %}
<main class="main">
  <section>
        <div class="container">
          <div class="main-div">
            {% if session["val"] %}
            <table class="table table-dark">
              <thead class="thead-light">
                <tr>
                  <th scope="col">Isbn</th>
                  <th scope="col">Title</th>
                  <th scope="col">Author</th>
                  <th scope="col">Year</th>
                </tr>
              </thead>
              <tbody>
                {% for val in data %}  
                <tr>         
                  <th scope="row"><a href="{{ url_for('book', id=val.isbn) }}">{{val.isbn}}</a></th>
                  <td><a href="{{ url_for('book', id=val.isbn) }}">{{val.title}}</a></td>
                  <td class="text-info">{{val.author}}</td>
                  <td class="text-primary">{{val.year}}</td>
                </tr>
                {% endfor %}             
              </tbody>
            </table>
            {% endif %}
            {% if session["book"] %}
            <div class="text-monospace border border-danger shadow-lg main-book">
              <div class="container text-monospace border-primary" >
                  <div class="row">
                      <div class="col-md-12" style="text-align: center;">
                          <h2 class="text-monospace text-capitalize text-success">Title : {{ title }} </h2>
                      </div>
                  </div>
                  <div class="row text-warning">
                      <div class="col-md-4 text-center p-3">ISBN : {{ isbns }}</div>
                      <div class="col-md-4 text-center p-3">Author : {{ author }} </div>
                      <div class="col-md-4 text-center p-3">Year : {{ year }}</div>
                      <div class="col-md-6 text-center p-3">Total Ratings : {{ count }} </div>
                      <div class="col-md-6 text-center p-3">Average Ratings : {{ avg_rates }}</div>
                      <div class="col-md-12 text-primary p-3" style="height: 300px;">
                        <form action="url_for('review')">
                          <div class="form-group m-1 p-1">
                            <label for="exampleFormControlSelect1">Review Book</label>
                            <select class="form-control" id="exampleFormControlSelect1" name="optreview">
                              <option>1</option>
                              <option>2</option>
                              <option>3</option>
                              <option>4</option>
                              <option>5</option>
                            </select>
                            <label for="exampleFormControlTextarea1">Example textarea</label>
                            <textarea class="form-control" id="exampleFormControlTextarea1" maxlength="300" placeholder="Type Book Reviews Here!" rows="3" name="txtarea"></textarea>
                          </div>
                          <button class="m-1 ml-2 p-1" type="submit" value="Submit">Submit</button>
                        </form>
                      </div>
                      <hr width="100%">
                      <div class="col-md-12 p-3" style="height: 120px;">
                        <h5 class="p-0 m-0 reviews">Reviews</h5>
                        <div class="p-0 m-1 overflow-auto">
                          {% for review in reviews %}
                          <span>{{ review }}</span>
                          {% endfor %}
                        </div>
                      </div>
                  </div>
              </div>
            </div>
            {% endif %}
          </div>
        </div>
      </section>
    </main>

{% endblock %}